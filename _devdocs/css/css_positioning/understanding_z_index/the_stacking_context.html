<h1>CSS Positioning: Understanding z index: The stacking context</h1> <p>The <strong>stacking context</strong> is a three-dimensional conceptualization of HTML elements along an imaginary z-axis relative to the user, who is assumed to be facing the viewport or the webpage. HTML elements occupy this space in priority order based on element attributes.</p> <h2 id="The_stacking_context">The stacking context</h2> <p>In the previous part of this article, <a href="../../understanding_z-index/adding_z-index">Using z-index</a>, the rendering order of certain elements is influenced by their <code>z-index</code> value. This occurs because these elements have special properties which cause them to form a <em>stacking context</em>.</p> <p>A stacking context is formed, anywhere in the document, by any element in the following scenarios:</p> <ul> <li>Root element of document (HTML).</li> <li>Element with a <a href="../../position"><code>position</code></a> value "absolute" or "relative" and <a href="../../z-index"><code>z-index</code></a> value other than "auto".</li> <li>Element with a <a href="../../position"><code>position</code></a> value "fixed" or "sticky" (sticky for all mobile browsers, but not older desktop).</li> <li>Element that is a child of a flex (<a href="../../css_flexible_box_layout/using_css_flexible_boxes"><code>flexbox</code></a>) container, with <a href="../../z-index"><code>z-index</code></a> value other than "auto".</li> <li>Element with a <a href="../../opacity"><code>opacity</code></a> value less than 1 (See <a href="http://www.w3.org/TR/css3-color/#transparency">the specification for opacity</a>).</li> <li>Element with a <a href="../../mix-blend-mode"><code>mix-blend-mode</code></a> value other than "normal".</li> <li>Element with any of the following properties with value other than "none": <ul> <li><a href="../../transform"><code>transform</code></a></li> <li><a href="../../filter"><code>filter</code></a></li> <li><a href="../../perspective"><code>perspective</code></a></li> <li><a href="../../clip-path"><code>clip-path</code></a></li> <li>
<a href="../../mask"><code>mask</code></a> / <a href="../../mask-image"><code>mask-image</code></a> / <a href="../../mask-border"><code>mask-border</code></a>
</li> </ul> </li> <li>Element with a <a href="../../isolation"><code>isolation</code></a> value "isolate".</li> <li>Element with a <a href="../../-webkit-overflow-scrolling"><code>-webkit-overflow-scrolling</code></a> value "touch".</li> <li>Element with a <a href="../../will-change"><code>will-change</code></a> value specifying any property that would create a stacking context on non-initial value (see <a href="http://dev.opera.com/articles/css-will-change-property/">this post</a>).</li> <li>Element with a <a href="../../contain"><code>contain</code></a> value of "layout", or "paint", or a composite value that includes either of them.</li> </ul> <p>Within a stacking context, child elements are stacked according to the same rules previously explained. Importantly, the z-index values of its child stacking contexts only have meaning in this parent. Stacking contexts are treated atomically as a single unit in the parent stacking context.</p> <p>In summary:</p> <ul> <li>Stacking contexts can be contained in other stacking contexts, and together create a hierarchy of stacking contexts.</li> <li>Each stacking context is completely independent from its siblings: only descendant elements are considered when stacking is processed.</li> <li>Each stacking context is self-contained: after the element's contents are stacked, the whole element is considered in the stacking order of the parent stacking context.</li> </ul> <div class="note">
<strong>Note:</strong> The hierarchy of stacking contexts is a subset of the hierarchy of HTML elements, because only certain elements create stacking contexts. We can say that elements that do not create their own stacking contexts are <em>assimilated</em> by the parent stacking context.</div> <h2 id="The_example">The example</h2> <p><img src="data:image/png;base64,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" alt="Example of stacking rules modified using z-index"></p> <p>In this example every positioned element creates its own stacking context, because of their positioning and z-index values. The hierarchy of stacking contexts is organized as follows:</p> <ul> <li>Root <ul> <li>DIV #1</li> <li>DIV #2</li> <li>DIV #3 <ul> <li>DIV #4</li> <li>DIV #5</li> <li>DIV #6</li> </ul> </li> </ul> </li> </ul> <p>It is important to note that DIV #4, DIV #5 and DIV #6 are children of DIV #3, so stacking of those elements is completely resolved within DIV#3. Once stacking and rendering within DIV #3 is completed, the whole DIV #3 element is passed for stacking in the root element with respect to its sibling's DIV.</p> <div class="note"> <p><strong>Notes:</strong></p> <ul> <li>DIV #4 is rendered under DIV #1 because DIV #1's z-index (5) is valid within the stacking context of the root element, while DIV #4's z-index (6) is valid within the stacking context of DIV #3. So, DIV #4 is under DIV #1, because DIV #4 belongs to DIV #3, which has a lower z-index value.</li> <li>For the same reason DIV #2 (z-index 2) is rendered under DIV#5 (z-index 1) because DIV #5 belongs to DIV #3, which has an higher z-index value.</li> <li>DIV #3's z-index is 4, but this value is independent from z-index of DIV #4, DIV #5 and DIV #6, because it belongs to a different stacking context.</li> <li>An easy way to figure out the <em>rendering order</em> of stacked elements along the Z axis is to think of it as a "version number" of sorts, where child elements are minor version numbers underneath their parent's major version numbers. This way we can easily see how an element with a z-index of 1 (DIV #5) is stacked above an element with a z-index of 2 (DIV #2), and how an element with a z-index of 6 (DIV #4) is stacked below an element with a z-index of 5 (DIV #1). In our example (sorted according to the final rendering order): <ul> <li>Root <ul> <li>DIV #2 - z-index is 2</li> <li>DIV #3 - z-index is 4 <ul> <li>DIV #5 - z-index is 1, stacked under an element with a z-index of 4, which results in a rendering order of 4.1</li> <li>DIV #6 - z-index is 3, stacked under an element with a z-index of 4, which results in a rendering order of 4.3</li> <li>DIV #4 - z-index is 6, stacked under an element with a z-index of 4, which results in a rendering order of 4.6</li> </ul> </li> <li>DIV #1 - z-index is 5</li> </ul> </li> </ul> </li> </ul> </div> <h2 id="Example">Example</h2> <h3 id="HTML">HTML</h3> <pre data-language="html">&lt;div id="div1"&gt;
  &lt;h1&gt;Division Element #1&lt;/h1&gt;
  &lt;code&gt;position: relative;&lt;br/&gt;
  z-index: 5;&lt;/code&gt;
&lt;/div&gt;

&lt;div id="div2"&gt;
  &lt;h1&gt;Division Element #2&lt;/h1&gt;
  &lt;code&gt;position: relative;&lt;br/&gt;
  z-index: 2;&lt;/code&gt;
&lt;/div&gt;

&lt;div id="div3"&gt;
  &lt;div id="div4"&gt;
    &lt;h1&gt;Division Element #4&lt;/h1&gt;
    &lt;code&gt;position: relative;&lt;br/&gt;
    z-index: 6;&lt;/code&gt;
  &lt;/div&gt;

  &lt;h1&gt;Division Element #3&lt;/h1&gt;
  &lt;code&gt;position: absolute;&lt;br/&gt;
  z-index: 4;&lt;/code&gt;

  &lt;div id="div5"&gt;
    &lt;h1&gt;Division Element #5&lt;/h1&gt;
    &lt;code&gt;position: relative;&lt;br/&gt;
    z-index: 1;&lt;/code&gt;
  &lt;/div&gt;
   
  &lt;div id="div6"&gt;
    &lt;h1&gt;Division Element #6&lt;/h1&gt;
    &lt;code&gt;position: absolute;&lt;br/&gt;
    z-index: 3;&lt;/code&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre> <h3 name="Division_Element_.231" id="Division_Element_.231">CSS</h3> <pre data-language="css">* {
  margin: 0;
}
html {
  padding: 20px;
  font: 12px/20px Arial, sans-serif;
}
div {
  opacity: 0.7;
  position: relative;
}
h1 {
  font: inherit;
  font-weight: bold;
}
#div1,
#div2 {
  border: 1px dashed #696;
  padding: 10px;
  background-color: #cfc;
}
#div1 {
  z-index: 5;
  margin-bottom: 190px;
}
#div2 {
  z-index: 2;
}
#div3 {
  z-index: 4;
  opacity: 1;
  position: absolute;
  top: 40px;
  left: 180px;
  width: 330px;
  border: 1px dashed #900;
  background-color: #fdd;
  padding: 40px 20px 20px;
}
#div4,
#div5 {
  border: 1px dashed #996;
  background-color: #ffc;
}
#div4 {
  z-index: 6;
  margin-bottom: 15px;
  padding: 25px 10px 5px;
}
#div5 {
  z-index: 1;
  margin-top: 15px;
  padding: 5px 10px;
}
#div6 {
  z-index: 3;
  position: absolute;
  top: 20px;
  left: 180px;
  width: 150px;
  height: 125px;
  border: 1px dashed #009;
  padding-top: 125px;
  background-color: #ddf;
  text-align: center;
}</pre> <h3 id="Result">Result</h3> <p><iframe src="https://mdn.mozillademos.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context%24samples/Example?revision=1437433" height="396" id="frame_Example" width="100%" frameborder="0" class="live-sample-frame sample-code-frame"></iframe></p> <h2 id="See_also">See also</h2> <ul> <li>
<a href="https://developer.mozilla.org/en/CSS/Understanding_z-index/Stacking_without_z-index">Stacking without the z-index property</a>: The stacking rules that apply when <code>z-index</code> is not used.</li> <li>
<a href="https://developer.mozilla.org/en/CSS/Understanding_z-index/Stacking_and_float">Stacking with floated blocks</a>: How floating elements are handled with stacking.</li> <li>
<a href="https://developer.mozilla.org/en/CSS/Understanding_z-index/Adding_z-index">Using z-index</a>: How to use <code>z-index</code> to change default stacking.</li> <li>
<a href="../../understanding_z-index/stacking_context_example_1">Stacking context example 1</a>: 2-level HTML hierarchy, z-index on the last level</li> <li>
<a href="../../understanding_z-index/stacking_context_example_2">Stacking context example 2</a>: 2-level HTML hierarchy, z-index on all levels</li> <li>
<a href="../../understanding_z-index/stacking_context_example_3">Stacking context example 3</a>: 3-level HTML hierarchy, z-index on the second level</li> </ul> <div class="originaldocinfo"> <h2 name="Original_Document_Information" id="Original_Document_Information">Original Document Information</h2> <ul> <li>Author(s): Paolo Lombardi</li> <li>This article is the English translation of an article I wrote in Italian for <a href="http://www.yappy.it">YappY</a>. I grant the right to share all the content under the <a href="http://creativecommons.org/licenses/by-sa/2.0/">Creative Commons: Attribution-Sharealike license</a>.</li> <li>Last Updated Date: July 9, 2005</li> </ul> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2018 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context</a>
  </p>
</div>
