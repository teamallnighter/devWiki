<h3 id="out-variables">Out Variables</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">PrintCoordinates</span><span class="p">(</span><span class="n">Point</span> <span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">p</span><span class="p">.</span><span class="nf">GetCoordinates</span><span class="p">(</span><span class="k">out</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="k">out</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
    <span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"(</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="s">, </span><span class="p">{</span><span class="n">y</span><span class="p">}</span><span class="s">)"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">out</code> is used to declare a variable at the point where it is passed as an argument.</p>

<h3 id="pattern-matching">Pattern Matching</h3>

<h4 id="is-expressions-with-patterns">Is-expressions with patterns</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">PrintStars</span><span class="p">(</span><span class="kt">object</span> <span class="n">o</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="k">is</span> <span class="k">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>     <span class="c1">// constant pattern "null"</span>
    <span class="k">if</span> <span class="p">(!(</span><span class="n">o</span> <span class="k">is</span> <span class="kt">int</span> <span class="n">i</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span> <span class="c1">// type pattern "int i"</span>
    <span class="nf">WriteLine</span><span class="p">(</span><span class="k">new</span> <span class="kt">string</span><span class="p">(</span><span class="sc">'*'</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="switch-statements-with-patterns">Switch statements with patterns</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">switch</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="n">Circle</span> <span class="n">c</span><span class="p">:</span>
        <span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"circle with radius </span><span class="p">{</span><span class="n">c</span><span class="p">.</span><span class="n">Radius</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">Rectangle</span> <span class="n">s</span> <span class="nf">when</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="n">s</span><span class="p">.</span><span class="n">Height</span><span class="p">):</span>
        <span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">s</span><span class="p">.</span><span class="n">Length</span><span class="p">}</span><span class="s"> x </span><span class="p">{</span><span class="n">s</span><span class="p">.</span><span class="n">Height</span><span class="p">}</span><span class="s"> square"</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">Rectangle</span> <span class="n">r</span><span class="p">:</span>
        <span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">r</span><span class="p">.</span><span class="n">Length</span><span class="p">}</span><span class="s"> x </span><span class="p">{</span><span class="n">r</span><span class="p">.</span><span class="n">Height</span><span class="p">}</span><span class="s"> rectangle"</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="nf">WriteLine</span><span class="p">(</span><span class="s">"&lt;unknown shape&gt;"</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="k">null</span><span class="p">:</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">shape</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="tuples">Tuples</h3>

<h4 id="tuple-type">Tuple type</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">)</span> <span class="nf">LookupName</span><span class="p">(</span><span class="kt">long</span> <span class="n">id</span><span class="p">)</span> <span class="c1">// tuple return type</span>
<span class="p">{</span>
    <span class="p">...</span> <span class="c1">// retrieve first, middle and last from data storage</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">last</span><span class="p">);</span> <span class="c1">// tuple literal</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">names</span> <span class="p">=</span> <span class="nf">LookupName</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"found </span><span class="p">{</span><span class="n">names</span><span class="p">.</span><span class="n">Item1</span><span class="p">}</span><span class="s"> </span><span class="p">{</span><span class="n">names</span><span class="p">.</span><span class="n">Item3</span><span class="p">}</span><span class="s">."</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="tuple-elements-with-name">Tuple elements with name</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kt">string</span> <span class="n">first</span><span class="p">,</span> <span class="kt">string</span> <span class="n">middle</span><span class="p">,</span> <span class="kt">string</span> <span class="n">last</span><span class="p">)</span> <span class="nf">LookupName</span><span class="p">(</span><span class="kt">long</span> <span class="n">id</span><span class="p">)</span> <span class="c1">// tuple elements have names</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">names</span> <span class="p">=</span> <span class="nf">LookupName</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"found </span><span class="p">{</span><span class="n">names</span><span class="p">.</span><span class="n">first</span><span class="p">}</span><span class="s"> </span><span class="p">{</span><span class="n">names</span><span class="p">.</span><span class="n">last</span><span class="p">}</span><span class="s">."</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="tuple-literals">Tuple Literals</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">return</span> <span class="p">(</span><span class="n">first</span><span class="p">:</span> <span class="n">first</span><span class="p">,</span> <span class="n">middle</span><span class="p">:</span> <span class="n">middle</span><span class="p">,</span> <span class="n">last</span><span class="p">:</span> <span class="n">last</span><span class="p">);</span> <span class="c1">// named tuple elements in a literal</span>
</code></pre></div></div>

<h4 id="tuple-deconstruction">Tuple Deconstruction</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kt">var</span> <span class="n">first</span><span class="p">,</span> <span class="kt">var</span> <span class="n">middle</span><span class="p">,</span> <span class="kt">var</span> <span class="n">last</span><span class="p">)</span> <span class="p">=</span> <span class="nf">LookupName</span><span class="p">(</span><span class="n">id1</span><span class="p">);</span>
<span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"found </span><span class="p">{</span><span class="n">first</span><span class="p">}</span><span class="s"> </span><span class="p">{</span><span class="n">last</span><span class="p">}</span><span class="s">."</span><span class="p">);</span>
</code></pre></div></div>
<p>or</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span> <span class="p">=</span> <span class="nf">LookupName</span><span class="p">(</span><span class="n">id1</span><span class="p">);</span> <span class="c1">// var outside</span>
</code></pre></div></div>
<p>or</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span> <span class="p">=</span> <span class="nf">LookupName</span><span class="p">(</span><span class="n">id2</span><span class="p">);</span> <span class="c1">// assign onto existing variables</span>
</code></pre></div></div>

<h3 id="local-functions">Local Functions</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="kt">int</span> <span class="nf">Fibonacci</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">"Less negativity please!"</span><span class="p">,</span> <span class="k">nameof</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
    <span class="k">return</span> <span class="nf">Fib</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">current</span><span class="p">;</span>

    <span class="p">(</span><span class="kt">int</span> <span class="n">current</span><span class="p">,</span> <span class="kt">int</span> <span class="n">previous</span><span class="p">)</span> <span class="nf">Fib</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
        <span class="kt">var</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span> <span class="p">=</span> <span class="nf">Fib</span><span class="p">(</span><span class="n">i</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">p</span> <span class="p">+</span> <span class="n">pp</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="literal-improvements">Literal Improvements</h3>

<h4 id="digit-separator-inside-numbers-literals">Digit Separator inside numbers literals</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">d</span> <span class="p">=</span> <span class="m">123</span><span class="n">_456</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0xAB</span><span class="n">_CD_EF</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="binary-literals">Binary Literals</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">b</span> <span class="p">=</span> <span class="m">0</span><span class="n">b1010_1011_1100_1101_1110_1111</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="ref-returns-and-locals">Ref Returns and Locals</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">ref</span> <span class="kt">int</span> <span class="nf">Find</span><span class="p">(</span><span class="kt">int</span> <span class="n">number</span><span class="p">,</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">numbers</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">numbers</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="n">number</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">ref</span> <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">// return the storage location, not the value</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="k">nameof</span><span class="p">(</span><span class="n">number</span><span class="p">)}</span><span class="s"> not found"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="p">[]</span> <span class="n">array</span> <span class="p">=</span> <span class="p">{</span> <span class="m">1</span><span class="p">,</span> <span class="m">15</span><span class="p">,</span> <span class="p">-</span><span class="m">39</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span> <span class="p">-</span><span class="m">12</span> <span class="p">};</span>
<span class="k">ref</span> <span class="kt">int</span> <span class="n">place</span> <span class="p">=</span> <span class="k">ref</span> <span class="nf">Find</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> <span class="n">array</span><span class="p">);</span> <span class="c1">// aliases 7's place in the array</span>
<span class="n">place</span> <span class="p">=</span> <span class="m">9</span><span class="p">;</span> <span class="c1">// replaces 7 with 9 in the array</span>
<span class="nf">WriteLine</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="m">4</span><span class="p">]);</span> <span class="c1">// prints 9</span>
</code></pre></div></div>

<h3 id="more-expression-bodied-members">More Expression Bodied Members</h3>

<p>C# 7.0 adds accessors, constructors and finalizers to the list of things that can have expression bodies:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="n">ConcurrentDictionary</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">names</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ConcurrentDictionary</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">id</span> <span class="p">=</span> <span class="nf">GetId</span><span class="p">();</span>

    <span class="k">public</span> <span class="nf">Person</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">names</span><span class="p">.</span><span class="nf">TryAdd</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span> <span class="c1">// constructors</span>
    <span class="p">~</span><span class="nf">Person</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">names</span><span class="p">.</span><span class="nf">TryRemove</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="k">out</span> <span class="p">*);</span>              <span class="c1">// destructors</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">names</span><span class="p">[</span><span class="n">id</span><span class="p">];</span>                                 <span class="c1">// getters</span>
        <span class="k">set</span> <span class="p">=&gt;</span> <span class="n">names</span><span class="p">[</span><span class="n">id</span><span class="p">]</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>                         <span class="c1">// setters</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="throw-expressions">Throw Expressions</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="nf">Person</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">Name</span> <span class="p">=</span> <span class="n">name</span> <span class="p">??</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">GetFirstName</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">parts</span> <span class="p">=</span> <span class="n">Name</span><span class="p">.</span><span class="nf">Split</span><span class="p">(</span><span class="s">" "</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">parts</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">?</span> <span class="n">parts</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">:</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">"No name!"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">GetLastName</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>
