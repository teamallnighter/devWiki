<h1>ReadableStream.constructor</h1><div class="overheadIndicator draft"> <p><strong>Draft</strong><br> This page is not complete.</p> </div><div class="notice overheadIndicator experimental"> <p> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Contribute/Guidelines/Conventions_definitions#Experimental">experimental technology</a></strong><br>Check the <a href="#Browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p> </div> <p class="summary">The <code>ReadableStream()</code> constructor creates and returns a readable stream object from the given handlers.</p> <h2 id="Syntax">Syntax</h2> <pre class="syntaxbox">var readableStream = new ReadableStream(<em>underlyingSource</em>[, queueingStrategy]);</pre> <h3 id="Parameters">Parameters</h3> <dl> <dt>underlyingSource</dt> <dd>An object containing methods and properties that define how the constructed stream instance will behave. <code>underlyingSource</code> can contain the following: <dl> <dt>start(controller)</dt> <dd>This is a method, called immediately when the object is constructed. The contents of this method are defined by the developer, and should aim to get access to the stream source, and do anything else required to set up the stream fuctionality. If this process is to be done asynchronously, it can return a promise to signal success or failure. The <code>controller</code> parameter passed to this method is a <a href="../readablestreamdefaultcontroller"><code>ReadableStreamDefaultController</code></a> or a <a href="../readablebytestreamcontroller"><code>ReadableByteStreamController</code></a>, depending on the value of the <code>type</code> property. This can be used by the developer to control the stream during set up.</dd> <dt>pull(controller) <span class="inlineIndicator optional optionalInline">Optional</span>
</dt> <dd>This method, also defined by the developer, will be called repeatedly when the stream's internal queue of chunks is not full, up until it reaches its high water mark. If <code>pull()</code> returns a promise, then it won't be called again until that promise fulfills; if the promise rejects, the stream will become errored. The <code>controller</code> parameter passed to this method is a <a href="../readablestreamdefaultcontroller"><code>ReadableStreamDefaultController</code></a> or a <a href="../readablebytestreamcontroller"><code>ReadableByteStreamController</code></a>, depending on the value of the <code>type</code> property. This can be used by the developer to control the stream as more chunks are fetched.</dd> <dt>cancel(reason) <span class="inlineIndicator optional optionalInline">Optional</span>
</dt> <dd>This method, also defined by the developer, will be called if the app signals that the stream is to be cancelled (e.g. if <a href="cancel"><code>ReadableStream.cancel()</code></a> is called). The contents should do whatever is necessary to release access to the stream source. If this process is asynchronous, it can return a promise to signal success or failure. The reason parameter contains a <a href="../domstring"><code>DOMString</code></a> describing why the stream was cancelled.</dd> <dt>type <span class="inlineIndicator optional optionalInline">Optional</span>
</dt> <dd>This property controls what type of readable stream is being dealt with. If it is included with a value set to <code>bytes</code>, the passed controller object will be a <a href="../readablebytestreamcontroller"><code>ReadableByteStreamController</code></a> capable of handling a BYOB (bring your own buffer)/byte stream. If it is not included, the passed controller will be a <a href="../readablestreamdefaultcontroller"><code>ReadableStreamDefaultController</code></a>.</dd> <dt>autoAllocateChunkSize <span class="inlineIndicator optional optionalInline">Optional</span>
</dt> <dd>For byte streams, the developer can set the <code>autoAllocateChunkSize</code> with a positive integer value to turn on the stream's auto-allocation feature. With this turned on, the stream implementation will automatically allocate an <a href="https://developer.mozilla.org/en-US/docs/Web/API/ArrayBuffer"><code>ArrayBuffer</code></a> with a size of the given integer, and call the underlying source code as if the consumer was using a BYOB reader.</dd> </dl> </dd> <dt>queueingStrategy <span class="inlineIndicator optional optionalInline">Optional</span>
</dt> <dd>An object that optionally defines a queueing strategy for the stream. This takes two parameters: <dl> <dt>highWaterMark</dt> <dd>A non-negative integer — this defines the total number of chunks that can be contained in the internal queue before backpressure is applied.</dd> <dt>size(chunk)</dt> <dd>A method containing a parameter <code>chunk</code> — this indicates the size to use for each chunk, in bytes.</dd> </dl> <div class="note"> <p><strong>Note</strong>: You could define your own custom <code>queueingStrategy</code>, or use an instance of <a href="https://developer.mozilla.org/en-US/docs/Web/API/ByteLengthQueueingStrategy"><code>ByteLengthQueueingStrategy</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/CountQueueingStrategy"><code>CountQueueingStrategy</code></a> for this object value. If no <code>queueingStrategy</code> is supplied, the default used is the same as a <code>CountQueuingStrategy</code> with a high water mark of 1.</p> </div> </dd> </dl> <h3 id="Return_value">Return value</h3> <p>An instance of the <a href="../readablestream"><code>ReadableStream</code></a> object.</p> <h3 id="Exceptions">Exceptions</h3> <dl> <dt>RangeError</dt> <dd>The supplied type value is neither <code>bytes</code> nor <code>undefined</code>.</dd> </dl> <h2 id="Examples">Examples</h2> <p>In the following simple example, a custom <code>ReadableStream</code> is created using a constructor (see our <a href="https://mdn.github.io/dom-examples/streams/simple-random-stream/">Simple random stream example</a> for the full code). The <code>start()</code> function generates a random string of text every second and enqueues it into the stream. A <code>cancel()</code> fuction is also provided to stop the generation if <a href="cancel"><code>ReadableStream.cancel()</code></a> is called for any reason.</p> <p>When a button is pressed, the generation is stopped, the stream is closed using <a href="../readablestreamdefaultcontroller/close"><code>ReadableStreamDefaultController.close()</code></a>, and another function is run, which reads the data back out of the stream.</p> <pre data-language="js">const stream = new ReadableStream({
  start(controller) {
    interval = setInterval(() =&gt; {
      let string = randomChars();

      // Add the string to the stream
      controller.enqueue(string);

      // show it on the screen
      let listItem = document.createElement('li');
      listItem.textContent = string;
      list1.appendChild(listItem);
    }, 1000);

    button.addEventListener('click', function() {
      clearInterval(interval);
      fetchStream();
      controller.close();
    })
  },
  pull(controller) {
    // We don't really need a pull in this example
  },
  cancel() {
    // This is called if the reader cancels,
    // so we should stop generating strings
    clearInterval(interval);
  }
});</pre> <h2 id="Specifications">Specifications</h2> <div class="_table"><table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://streams.spec.whatwg.org/#rs-constructor" hreflang="en">Streams<br><small>The definition of 'ReadableStream()' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>Initial definition.</td> </tr> </tbody> </table></div> <h2 id="Browser_compatibility">Browser compatibility<a href="https://github.com/mdn/browser-compat-data" class="bc-github-link">Update compatibility data on GitHub</a>
</h2>  <div class="_table">
<table class="bc-table bc-table-web">
<thead>
<tr class="bc-platforms">
<th></th>
<th colspan="6">Desktop</th>
</tr>
<tr class="bc-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
</tr>
</thead>
<tbody><tr>
<th scope="row">Basic support 
</th>
<td class="bc-supports-yes"> 43</td>
<td class="bc-supports-yes"> 16</td>
<td class="bc-supports-yes bc-has-history"> 57<div class="bc-icons">Disabled </div>
<dl>
<dt class="bc-supports-yes bc-supports"> 57<div class="bc-icons">Disabled </div>
</dt>
<dd>Disabled From version 57: this feature is behind the <code>dom.streams.enabled</code> preference (needs to be set to <code>true</code>) and the <code>javascript.options.streams</code> preference (needs to be set to <code>true</code>). To change preferences in Firefox, visit about:config.</dd>
</dl>
</td>
<td class="bc-supports-no"> No</td>
<td class="bc-supports-yes"> 30</td>
<td> ? </td>
</tr></tbody>
</table>
<table class="bc-table bc-table-web">
<thead>
<tr class="bc-platforms">
<th></th>
<th colspan="7">Mobile</th>
</tr>
<tr class="bc-browsers">
<th></th>
<th>Android webview</th>
<th>Chrome for Android</th>
<th>Edge Mobile</th>
<th>Firefox for Android</th>
<th>Opera for Android</th>
<th>iOS Safari</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody><tr>
<th scope="row">Basic support 
</th>
<td class="bc-supports-yes"> 43</td>
<td class="bc-supports-yes"> 43</td>
<td class="bc-supports-yes"> 16</td>
<td class="bc-supports-yes bc-has-history"> 57<div class="bc-icons">Disabled </div>
<dl>
<dt class="bc-supports-yes bc-supports"> 57<div class="bc-icons">Disabled </div>
</dt>
<dd>Disabled From version 57: this feature is behind the <code>dom.streams.enabled</code> preference (needs to be set to <code>true</code>) and the <code>javascript.options.streams</code> preference (needs to be set to <code>true</code>). To change preferences in Firefox, visit about:config.</dd>
</dl>
</td>
<td class="bc-supports-yes"> 30</td>
<td> ? </td>
<td class="bc-supports-yes"> 4.0</td>
</tr></tbody>
</table>
</div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/ReadableStream$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2018 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/ReadableStream" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/ReadableStream</a>
  </p>
</div>
